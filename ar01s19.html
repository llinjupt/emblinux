<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>19. &#20869;&#26680;&#36890;&#30693;&#38142;</title><link rel="stylesheet" href="styles.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="index.html" title="Linux&#20869;&#26680;&#23398;&#20064;&#21644;&#30740;&#31350;&#21450;&#23884;&#20837;&#24335;(ARM)&#23398;&#20064;&#21644;&#30740;&#31350;&#30340;&#24320;&#25918;&#25991;&#26723;"><link rel="up" href="index.html" title="Linux&#20869;&#26680;&#23398;&#20064;&#21644;&#30740;&#31350;&#21450;&#23884;&#20837;&#24335;(ARM)&#23398;&#20064;&#21644;&#30740;&#31350;&#30340;&#24320;&#25918;&#25991;&#26723;"><link rel="prev" href="ar01s18.html" title="18. &#26102;&#38047;&#31649;&#29702;"><link rel="next" href="ar01s20.html" title="20. &#20869;&#26680;&#21516;&#27493;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">19. &#20869;&#26680;&#36890;&#30693;&#38142;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s18.html">&#19978;&#19968;&#39029;</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s20.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="sect1" title="19. &#20869;&#26680;&#36890;&#30693;&#38142;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp81601668"></a>19. &#20869;&#26680;&#36890;&#30693;&#38142;</h2></div></div></div>
<div class="sect2" title="19.1. &#27010;&#36848;"><div class="titlepage"><div><div><h3 class="title"><a name="idp81602452"></a>19.1. &#27010;&#36848;</h3></div></div></div>
<p>
&#22312;Linux&#20869;&#26680;&#20013;&#65292;&#21508;&#20010;&#23376;&#31995;&#32479;&#20043;&#38388;&#26377;&#24456;&#24378;&#30340;&#30456;&#20114;&#20851;&#31995;&#65292;&#26576;&#20123;&#23376;&#31995;&#32479;&#21487;&#33021;&#23545;&#20854;&#23427;&#23376;&#31995;&#32479;&#20135;&#29983;&#30340;&#20107;&#20214;&#24863;&#20852;&#36259;&#12290;&#20026;&#20102;&#35753;&#26576;&#20010;&#23376;&#31995;&#32479;&#22312;&#21457;&#29983;&#26576;&#20010;&#20107;&#20214;&#26102;&#36890;&#30693;&#24863;&#20852;&#36259;&#30340;&#23376;&#31995;&#32479;&#65292;Linux&#20869;&#26680;&#24341;&#20837;&#20102;&#36890;&#30693;&#38142;&#25216;&#26415;&#12290;&#36890;&#30693;&#38142;&#21482;&#33021;&#22815;&#22312;&#20869;&#26680;&#30340;&#23376;&#31995;&#32479;&#20043;&#38388;&#20351;&#29992;&#65292;&#32780;&#19981;&#33021;&#22815;&#22312;&#20869;&#26680;&#21644;&#29992;&#25143;&#31354;&#38388;&#36827;&#34892;&#20107;&#20214;&#30340;&#36890;&#30693;&#12290;</p>
<p>
&#32452;&#25104;&#20869;&#26680;&#30340;&#26680;&#24515;&#31995;&#32479;&#20195;&#30721;&#22343;&#20301;&#20110;kernel&#30446;&#24405;&#19979;&#65292;&#36890;&#30693;&#38142;&#34920;&#23601;&#20301;&#20110;&#20854;&#20013;&#65292;&#23427;&#20301;&#20110;kernel/notifier.c&#20013;&#65292;&#23545;&#24212;&#30340;&#22836;&#25991;&#20214;&#20026;include/linux/notifier.h&#12290;&#36890;&#30693;&#38142;&#34920;&#26426;&#21046;&#24182;&#19981;&#22797;&#26434;&#65292;&#23454;&#29616;&#23427;&#30340;&#20195;&#30721;&#21482;&#26377;&#21306;&#21306;&#20960;&#30334;&#34892;&#12290;
</p>
</div>
<div class="sect2" title="19.2. &#25968;&#25454;&#32467;&#26500;"><div class="titlepage"><div><div><h3 class="title"><a name="idp81603868"></a>19.2. &#25968;&#25454;&#32467;&#26500;</h3></div></div></div>
&#25152;&#26377;&#36890;&#30693;&#38142;&#30340;&#26680;&#24515;&#25968;&#25454;&#32467;&#26500;&#37117;&#20301;&#20110;notifier.h&#20013;&#12290;&#36890;&#30693;&#38142;&#30340;&#26680;&#24515;&#32467;&#26500;&#26159;notifier_block &#12290;
<pre class="programlisting">
struct notifier_block {
        int (*notifier_call)(struct notifier_block *, unsigned long, void *);
        struct notifier_block *next;
        int priority;
};
</pre>
&#20854;&#20013;notifier_call&#26159;&#36890;&#30693;&#38142;&#35201;&#25191;&#34892;&#30340;&#20989;&#25968;&#25351;&#38024;&#65292;next&#29992;&#26469;&#36830;&#25509;&#20854;&#23427;&#30340;&#36890;&#30693;&#32467;&#26500;&#65292;priority&#26159;&#36825;&#20010;&#36890;&#30693;&#30340;&#20248;&#20808;&#32423;&#65292;&#21516;&#19968;&#26465;&#38142;&#19978;&#30340;notifier_block&#26159;&#25353;&#20248;&#20808;&#32423;&#25490;&#21015;&#30340;&#12290;&#20869;&#26680;&#20195;&#30721;&#20013;&#19968;&#33324;&#25226;&#36890;&#30693;&#38142;&#21629;&#21517;&#20026;xxx_chain, xxx_nofitier_chain&#36825;&#31181;&#24418;&#24335;&#30340;&#21464;&#37327;&#21517;&#12290;&#22260;&#32469;&#26680;&#24515;&#25968;&#25454;&#32467;&#26500;notifier_block&#65292;&#20869;&#26680;&#23450;&#20041;&#20102;&#22235;&#31181;&#36890;&#30693;&#38142;&#31867;&#22411;&#65306;<br>
<p>
<span class="emphasis"><em>1.</em></span>&#21407;&#23376;&#36890;&#30693;&#38142;&#65288; Atomic notifier chains &#65289;&#65306;&#36890;&#30693;&#38142;&#20803;&#32032;&#30340;&#22238;&#35843;&#20989;&#25968;&#65288;&#24403;&#20107;&#20214;&#21457;&#29983;&#26102;&#35201;&#25191;&#34892;&#30340;&#20989;&#25968;&#65289;&#22312;&#20013;&#26029;&#25110;&#21407;&#23376;&#25805;&#20316;&#19978;&#19979;&#25991;&#20013;&#36816;&#34892;&#65292;&#19981;&#20801;&#35768;&#38459;&#22622;&#12290;&#23545;&#24212;&#30340;&#38142;&#34920;&#22836;&#32467;&#26500;&#65306;
</p><pre class="programlisting">
struct atomic_notifier_head {
        spinlock_t lock;
        struct notifier_block *head;
};
</pre><p>
</p><p>
<span class="emphasis"><em>2.</em></span>&#21487;&#38459;&#22622;&#36890;&#30693;&#38142;&#65288; Blocking notifier chains &#65289;&#65306;&#36890;&#30693;&#38142;&#20803;&#32032;&#30340;&#22238;&#35843;&#20989;&#25968;&#22312;&#36827;&#31243;&#19978;&#19979;&#25991;&#20013;&#36816;&#34892;&#65292;&#20801;&#35768;&#38459;&#22622;&#12290;&#23545;&#24212;&#30340;&#38142;&#34920;&#22836;&#65306;
</p><pre class="programlisting">
struct blocking_notifier_head {
        struct rw_semaphore rwsem;
        struct notifier_block *head;
};
</pre><p>
</p>
<p>
<span class="emphasis"><em>3.</em></span>&#21407;&#22987;&#36890;&#30693;&#38142;&#65288; Raw notifier chains &#65289;&#65306;&#23545;&#36890;&#30693;&#38142;&#20803;&#32032;&#30340;&#22238;&#35843;&#20989;&#25968;&#27809;&#26377;&#20219;&#20309;&#38480;&#21046;&#65292;&#25152;&#26377;&#38145;&#21644;&#20445;&#25252;&#26426;&#21046;&#37117;&#30001;&#35843;&#29992;&#32773;&#32500;&#25252;&#12290;&#23545;&#24212;&#30340;&#38142;&#34920;&#22836;&#65306;
</p><pre class="programlisting">
struct raw_notifier_head {
        struct notifier_block *head;
};
</pre><p>
</p><p>
<span class="emphasis"><em>4.</em></span>SRCU &#36890;&#30693;&#38142;&#65288; SRCU notifier chains &#65289;&#65306;&#21487;&#38459;&#22622;&#36890;&#30693;&#38142;&#30340;&#19968;&#31181;&#21464;&#20307;&#12290;&#23545;&#24212;&#30340;&#38142;&#34920;&#22836;&#65306;
</p><pre class="programlisting">
struct srcu_notifier_head {
        struct mutex mutex;
        struct srcu_struct srcu;
        struct notifier_block *head;
};
</pre><p>
</p>
</div>
<div class="sect2" title="19.3. &#36816;&#20316;&#26426;&#21046;"><div class="titlepage"><div><div><h3 class="title"><a name="idp81609484"></a>19.3. &#36816;&#20316;&#26426;&#21046;</h3></div></div></div>
<p>
&#36890;&#30693;&#38142;&#30340;&#36816;&#20316;&#26426;&#21046;&#21253;&#25324;&#20004;&#20010;&#35282;&#33394;&#65306;
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">&#34987;&#36890;&#30693;&#32773;&#65306;&#23545;&#26576;&#19968;&#20107;&#20214;&#24863;&#20852;&#36259;&#19968;&#26041;&#12290;&#23450;&#20041;&#20102;&#24403;&#20107;&#20214;&#21457;&#29983;&#26102;&#65292;&#30456;&#24212;&#30340;&#22788;&#29702;&#20989;&#25968;&#65292;&#21363;&#22238;&#35843;&#20989;&#25968;&#65292;&#34987;&#36890;&#30693;&#32773;&#23558;&#20854;&#27880;&#20876;&#21040;&#36890;&#30693;&#38142;&#20013;&#65288;&#34987;&#36890;&#30693;&#32773;&#27880;&#20876;&#30340;&#21160;&#20316;&#23601;&#26159;&#22312;&#36890;&#30693;&#38142;&#20013;&#22686;&#21152;&#19968;&#39033;&#65289;&#12290;</li><li class="listitem">&#36890;&#30693;&#32773;&#65306;&#20107;&#20214;&#30340;&#36890;&#30693;&#32773;&#12290;&#24403;&#26816;&#27979;&#21040;&#26576;&#20107;&#20214;&#65292;&#25110;&#32773;&#26412;&#36523;&#20135;&#29983;&#20107;&#20214;&#26102;&#65292;&#36890;&#30693;&#25152;&#26377;&#23545;&#35813;&#20107;&#20214;&#24863;&#20852;&#36259;&#30340;&#19968;&#26041;&#20107;&#20214;&#21457;&#29983;&#12290;&#23427;&#23450;&#20041;&#20102;&#19968;&#20010;&#36890;&#30693;&#38142;&#65292;&#20854;&#20013;&#20445;&#23384;&#20102;&#27599;&#19968;&#20010;&#34987;&#36890;&#30693;&#32773;&#23545;&#20107;&#20214;&#30340;&#22238;&#35843;&#20989;&#25968;&#12290;&#36890;&#30693;&#36825;&#20010;&#36807;&#31243;&#23454;&#38469;&#19978;&#23601;&#26159;&#36941;&#21382;&#36890;&#30693;&#38142;&#20013;&#30340;&#27599;&#19968;&#39033;&#65292;&#28982;&#21518;&#35843;&#29992;&#30456;&#24212;&#30340;&#22238;&#35843;&#20989;&#25968;&#12290;</li></ul></div><p>
&#21253;&#25324;&#20197;&#19979;&#36807;&#31243;&#65306;
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">&#36890;&#30693;&#32773;&#23450;&#20041;&#36890;&#30693;&#38142;&#12290;</li><li class="listitem">&#34987;&#36890;&#30693;&#32773;&#21521;&#36890;&#30693;&#38142;&#20013;&#27880;&#20876;&#22238;&#35843;&#20989;&#25968;&#12290;</li><li class="listitem">&#24403;&#20107;&#20214;&#21457;&#29983;&#26102;&#65292;&#36890;&#30693;&#32773;&#21457;&#20986;&#36890;&#30693;&#65288;&#25191;&#34892;&#36890;&#30693;&#38142;&#20013;&#25152;&#26377;&#20803;&#32032;&#30340;&#22238;&#35843;&#20989;&#25968;&#65289;&#12290;</li></ul></div><p>
</p>
</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s18.html">&#19978;&#19968;&#39029;</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s20.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">18. &#26102;&#38047;&#31649;&#29702; </td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top"> 20. &#20869;&#26680;&#21516;&#27493;</td></tr></table></div></body></html>
